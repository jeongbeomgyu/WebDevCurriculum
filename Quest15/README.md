# Quest 15. 자동화된 테스트

## Introduction

- 이번 퀘스트에서는 자동화된 테스트에 어떤 장점이 있는지, 어떤 식으로 구축할 수 있는지에 대해 알아보겠습니다.

## Topics

- Automated Test
  - TDD
  - Unit Test
  - Integration Test
  - E2E Test
  - Stub & Mock
- Jest
- Puppeteer

## Resources

- [Unit Test (단위 테스트) 도입하기](https://www.popit.kr/unit-test-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%8F%84%EC%9E%85%ED%95%98%EA%B8%B0-1%ED%8E%B8/)
- [소프트웨어 테스트 안티 패턴](https://velog.io/@leejh3224/%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%95%88%ED%8B%B0-%ED%8C%A8%ED%84%B4)
- [End-to-End testing with Puppeteer and Jest](https://medium.com/touch4it/end-to-end-testing-with-puppeteer-and-jest-ec8198145321)
- [Mock & Stub](https://stackoverflow.com/questions/3459287/whats-the-difference-between-a-mock-stub)

## Checklist

- 자동화된 테스트를 만드는 것에는 어떤 장점과 단점이 있을까?

자동화된 테스트를 만들면 수작업으로 테스트를 수행하는 것보다 빠르고, 반복적인 테스트를 수행할 때 시간과 비용을 절약할 수 있고, 코드 변경사항을 빠르게 테스트할 수 있기 때문에 버그를 일찍 발견할 수 있다. 또한 코드의 대부분을 커버할 수 있기 때문에 코드의 테스트 커버리지를 높일 수 있으며 코드 변경에 따른 영향도를 미리 파악할 수 있기 때문에 코드의 유지보수성을 향상할 수 있다. 단점은 자동화된 테스트를 만들기 위한 초기 투자 비용이 필요하고 테스트가 모든 케이스를 커버하지 못하는 경우가 발생하여 수동으로 테스트를 추가적으로 수행할 경우가 발생할 수 있다. 또한 자동화된 테스트 코드 역시 버그가 발생할 수 있으므로 유지보수가 필요하며, 자동화된 테스트 코드 작성에 대한 경험이 필요하다.

- TDD(Test-Driven Development)란 무엇인가요? TDD의 장점과 단점은 무엇일까요?

TDD는 스프트웨어를 개발할 때 테스트 코드를 먼저 작성하고, 이에 맞는 코드를 작성하는 개발 방법론으로 테스트 코드를 먼저 작성하고, 이를 통과할 수 있는 최소한의 코드를 작성한다. 그리고 작성한 코드를 리팩토링하여 성능과 가독성을 개선한다. TDD의 장점으로는 코드의 결함을 초기에 발견할 수 있어서 개발 과정에서 발생하는 결함이 줄어들고, TDD는 작은 단위의 코드를 작성하게 하므로, 이해하기 쉬운 작은 함수들로 이루어진 코드가 만들어져 코드의 가독성과 유지보수를 편하게 만들어준다. 마지막으로 TDD는 코드를 작성할 때 자동화된 테스트를 만들기 때문에, 코드의 품질을 개선한다. 단점으로는 TDD는 테스트 코드를 작성하고 이에 맞는 코드를 작성하기 때문에, 초기 개발 단계에서는 시간이 더 걸릴 수 있고, 테스트 코드를 작성하기 어려울 수 있다. 마지막으로 TDD를 도입하려면 기존 코드를 재작성해야 할 수 있는 기존 코드와의 호환성 문제가 발생할 수 있다.

- 테스트들 간의 계층에 따라 어떤 단계들이 있을까요?

단위테스트, 통합테스트, 시스템 테스트, 인스 테스트가 있다. 단위 테스트는 개별적인 모듈, 함수, 클래스 등의 동작을 테스트하기 때문에 코드 작성 이후 가장 먼저 수행된다. 통합 테스트는 단위 테스트가 끝나면 여러 모듈이 함께 작동하는 상황을 테스트한다. 시스템 테스트는 통합 테스트가 끝나면 시스템 전테의 동작을 테스트 하기 때문에 UI같은 외부 인터페이스를 포함한다. 인수 테스트는 시스템 테스트가 끝난 후 최종 사용자가 시스템이 예상대로 동작하는지 확인한다.

- 유닛 테스트, 통합 테스트, E2E 테스트는 각각 어떤 것을 뜻하나요?

유닛 테스트는 소프트웨어의 개별 컴포넌트(함수,모듈 등)를 검증하는 테스트로, 해당 컴포넌트가 의도한 대로 동작하는지 여부를 검증하고 모의 객체 등을 사용하여 의존성을 제어한다. 통합 테스트는 여러 개의 컴포넌트를 조합하여 시스템 전체가 의도한 대로 동작하는지 여부를 검증하는 테스트로, 컴포넌트 간의 상호작용, 데이터의 흐름등을 검증하고 실제 데이터베이스나 외부 API를 사용한다. E2E 테스트는 시스템 전체를 검증하는 테스트로, 사용자의 시나리오에 따라 실제 브라우저나 모바일 앱에서 시스템을 실행시켜 검증하고 사용자의 관점에서 시스템이 의도한 대로 동작하는지를 검증한다.

- 테스트에 있어서 Stub과 Mock은 어떤 개념을 가리키는 것일까요?

stub은 인터페이스를 구현하여 특정 메서드를 대체하는 객체이다. 테스트에서 stub을 사용하면 특정 메서드의 반환 값을 미리 지정하거나 예외를 발생시켜 테스트를 제어할 수 있다. Mock는 인테페이스를 구현하는 객체로서 테스트 중에 호출되는 메서드와 해당 메서드에 전달되는 인자들을 추적할 수 있다. 테스트에서 Monk를 사용하면 메서드가 호출되는지, 호출된 횟수는 얼마나 되는지, 그리고 올바른 인자들이 전달되는지를 검증할 수 있다. 즉 stub은 객체의 반환값을 설정하고, Mock는 객체가 호출된 것을 확인하고 해당 호출 결과를 검증하는 것이다.

- Jest는 어떤 일을 하며 어떻게 사용하는 테스트 프레임워크일까요?

Jest는 자바스크립트 테스트 프레임워크로 유닛 테스트, 통합 테스트, 스냅샷 테스트, 비동기 테스트 등 다양한 테스트를 지원한다. Jest는 Babel을 이용해 자바스크립트 코드를 ES5문법으로 변환한 뒤 실행하기 때문에 자바스크립트 문법을 사용해도 테스트를 작성할 수 있다. 또한 watch 모드를 지원하여 파일 변경 시 자동으로 테스트를 실행하도록 설정할 수 있다. Jest의 기능에는 자동으로 모든 테스트 파일을 찾아서 실행하거나 dsecribe()it()과 같은 함수들을 이용한 테스트 코드 작성, expect() 함수를 이용한 값 검증, Mock 함수를 이용한 모의 객체 생성, Snapshot 테스트를 통한 UI컴포넌트 테스트 등이 있다.

- Jest 이외의 테스트 프레임워크는 어떤 것이 있고 어떤 장단점이 있을까요?
  자바스크립트로 된 테스트 프레임워크인 Mocha는 다양한 언어와 라이브러리를 지원하고, BDD와 TDD 스타일을 모두 지원하기 때문에 유연하며 다양한 기능을 제공하지만 초기 설정이 복잡하고, 설치 후 설정에 시간을 소요해햐한다는 단점이 있다. BDD 스타일의 테스트 프레임워크은 Jasmine은 모든 기능이 내장되어 있어 별도의 라이브러리를 필요로 하지 않고 내장된 기능이 많아 사용이 간편하지만, React 및 TypeScript 등 최신 기술과의 호환성이 떨어진다. Node.js기반의 테스트 프레임워크인 Ava는 비동기 코드를 처리하는데 최적화 되어있어 속도가 빠르며, 병렬 처리를 지원해 주지만, 기능이 제한적이며, Jest보다 생산성이 떨어진다는 단점이 있다.

- Puppeteer는 어떤 일을 하며 어떻게 사용하는 테스트 프레임워크일까요?

Puppeteer는 Node.js 기반의 테스트 프레임워크로 웹브라우저를 제어할 수 있는 라이브러리이며, 테스트 자동화나 스크래핑 등 다양한 용도로 사용된다. Puppeteer는 웹 페이지를 로드하고, 페이지 내의 DOM 요소를 선택하거나 조작할 수 있고, 웹 페이즈의 캡처를 생성하거나 PDF로 출력할 수 있다. 또한 사용자의 행동을 시뮬레이션하고, 자동화된 UI테스트를 수행할 수 있고, 서버사이드 랜더링에 사용될 수 있다.

## Quest

- 직전 퀘스트의 메모장의 서버와 클라이언트 각 부분에 유닛 테스트, 통합 테스트, E2E 테스트 등을 추가해 보세요.
  - `npm test` 명령을 통해 모든 테스트가 돌고 그 결과를 출력할 수 있어야 합니다.

## Advanced

- 테스트의 커버리지는 어떤 개념일까요? 프로젝트에서 테스트의 커버리지는 어떻게 접근하는 것이 좋을까요?
